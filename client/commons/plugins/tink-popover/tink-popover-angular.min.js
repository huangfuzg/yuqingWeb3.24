/*! tink-popover-angular v1.0.7 */
"use strict";!function(module){try{module=angular.module("tink.popover")}catch(e){module=angular.module("tink.popover",[])}module.directive("tinkPopover",["$q","$templateCache","$http","$compile","$timeout","$window","$rootScope",function($q,$templateCache,$http,$compile,$timeout,$window,$rootScope){return{restrict:"EA",scope:!0,compile:function(tElement,attrs){function getTemplate(template){return fetchPromises[template]?fetchPromises[template]:fetchPromises[template]=$q.when($templateCache.get(template)||$http.get(template)).then(function(res){return angular.isObject(res)?($templateCache.put(template,res.data),res.data):res})}var fetchPromises={},theTemplate=null;return attrs.tinkPopoverTemplate&&(theTemplate=getTemplate(attrs.tinkPopoverTemplate)),{post:function(scope,element,attributes){function popoverHtml(){var html='<div class="popover {{arrowPlacement}}"><span class="arrow"></span></div>';return html}function childOf(c,p){for(;(c=c.parentNode)&&c!==p;);return!!c}function show(){null!==theTemplate&&theTemplate.then(function(data){if(null===isOpen){var elContent=$($compile("<div>"+data+"</div>")(scope)),el=$($compile(popoverHtml())(scope));el.css("position","absolute"),el.css("visibility","hidden"),elContent.insertAfter(el.find("span")),"top"===placement?element.before(el):element.after(el),el.css("top",-100),el.css("left",-10),calcPos(element,el,placement,align,spacing),attributes.tinkPopoverGroup&&$rootScope.$broadcast("popover-open",{group:attributes.tinkPopoverGroup,el:el}),isOpen=el}})}function hide(){null!==isOpen&&(isOpen.remove(),isOpen=null)}function getPos(el,placement,align,spacing){var porcent={right:.85,left:.15,top:.15,bottom:.85},arrowHeight=0,arrowWidth=0;("undefined"==typeof arrow||"true"===arrow)&&(arrowHeight=10,arrowWidth=10);var alignLeft=0,alignTop=0;"center"===align?(alignLeft=el.outerWidth(!0)/2-element.outerWidth(!0)/2,alignTop=0):"left"===align||"right"===align?alignLeft=el.outerWidth(!0)*porcent[align]-element.outerWidth(!0)/2:("top"===align||"bottom"===align)&&(alignTop=0);var left=element.position().left-alignLeft,top=null;return"top"===placement?top=element.position().top-(el.outerHeight()+arrowHeight+spacing):"bottom"===placement?top=element.position().top+element.outerHeight()+arrowHeight+spacing:"right"===placement?left=element.position().left+element.outerWidth(!0)+arrowWidth+spacing:"left"===placement&&(left=element.position().left-el.outerWidth(!0)-arrowWidth-spacing),"right"===align?left=element.position().left+(element.outerWidth(!0)-el.outerWidth(!0)):"left"===align?left=element.position().left:"top"===align?top=element.position().top:"bottom"===align?top=element.position().top-el.outerHeight(!0)+element.outerHeight(!0):"center"===align&&("top"===placement||"bottom"===placement?left=element.position().left-(el.outerWidth(!0)/2-element.outerWidth(!0)/2):("left"===placement||"right"===placement)&&(top=element.position().top-(el.outerHeight(!0)/2-element.outerHeight(!0)/2))),{top:top,left:left,place:placement,align:align}}function arrowCal(placement,align){if("undefined"==typeof arrow||"true"===arrow){var arrowCss="arrow-";switch(placement){case"left":arrowCss+="right";break;case"right":arrowCss+="left";break;case"top":arrowCss+="bottom";break;case"bottom":arrowCss+="top"}switch(align){case"center":break;case"top":case"bottom":("right"===placement||"left"===placement)&&(arrowCss=arrowCss+"-"+align);break;case"left":case"right":("top"===placement||"bottom"===placement)&&(arrowCss=arrowCss+"-"+align)}scope.arrowPlacement=arrowCss}}function calcPos(element,el,place,align,spacing){function calcPostInside(){var data=getPos(el,place,align,spacing);el.css("top",data.top),el.css("left",data.left),arrowCal(data.place,data.align)}var pageScrollY=$window.scrollY||$window.pageYOffset,pageScrollX=$window.scrollX||$window.pageXOffset,w1=element.offset().left-pageScrollX,w2=$window.innerWidth-(w1+element.outerWidth(!0)),h1=element.offset().top-Math.ceil(parseFloat($("body").css("padding-top")))-pageScrollY,h2=$window.innerHeight-(h1+element.outerHeight(!0));place&&("top"===place?el.outerHeight(!0)+spacing+10>h1&&(place=void 0,align=void 0):"bottom"===place?el.outerHeight(!0)+spacing+10>h2&&(place=void 0,align=void 0):"left"===place?el.outerWidth(!0)-element.outerWidth(!0)>w1&&(place=void 0,align=void 0):"right"===place?el.outerWidth(!0)-element.outerWidth(!0)>w2&&(place=void 0,align=void 0):(place=void 0,align=void 0)),place||(place=h1>element.outerHeight()||h2>element.outerHeight()?h1>h2?"top":"bottom":w1>element.outerWidth()||w2>element.outerWidth()?w1>w2?"left":" right":"bottom");var val;align&&("left"===place||"right"===place?"top"===align?el.outerHeight(!0)-element.outerHeight(!0)>h2&&(align=void 0):"bottom"===align?el.outerHeight(!0)-element.outerHeight(!0)>h1&&(align=void 0):"center"===align&&(val=(el.outerHeight(!0)-element.outerHeight(!0))/2,(val>h1||val>h2)&&(align=void 0)):("top"===place||"bottom"===place)&&("left"===align?el.outerWidth(!0)-element.outerWidth(!0)>w2&&(align=void 0):"right"===align?el.outerWidth(!0)-element.outerWidth(!0)>w1&&(align=void 0):"center"===align&&(val=(el.outerWidth(!0)-element.outerWidth(!0))/2,(val>w1||val>w2)&&(align=void 0)))),align||("left"===place||"right"===place?align=h1>h2?"bottom":"top":("top"===place||"bottom"===place)&&(align=w1>w2?"right":"left")),$timeout(function(){calcPostInside(),el.css("visibility","visible")},20),$timeout(function(){el.addClass("popover-transition")},250)}var placement=attributes.tinkPopoverPlace,align=attributes.tinkPopoverAlign,arrow=attributes.tinkArrow,trigger="click",spacing=2,isOpen=null;"click"===trigger?element.bind("click",function(){scope.$apply(function(){null===isOpen?show():hide()})}):"hover"===trigger&&(element.bind("mouseenter",function(){show()}),element.bind("mouseleave",function(){hide()})),$(document).bind("click",function(e){var clicked=$(e.target).parents(".popover").last(),group=$(e.target).attr("tink-popover-group");isOpen&&!childOf($(e.target).get(0),element.get(0))&&($(e.target).get(0)!==element.get(0)||clicked.length>0)&&isOpen.get(0)!==clicked.get(0)&&$(e.target).get(0)!==isOpen.get(0)&&attributes.tinkPopoverGroup!==group&&hide()}),attributes.tinkPopoverGroup&&scope.$on("popover-open",function(event,args){var group=args.group;group!==attributes.tinkPopoverGroup&&isOpen&&$(args.el).get(0)!==isOpen.get(0)&&hide()});var timeoutResize=null;$window.addEventListener("resize",function(){null!==isOpen&&($timeout.cancel(timeoutResize),timeoutResize=$timeout(function(){calcPos(element,isOpen,placement,align,spacing)},250))},!0),$window.addEventListener("scroll",function(){null!==isOpen&&($timeout.cancel(timeoutResize),timeoutResize=$timeout(function(){calcPos(element,isOpen,placement,align,spacing)},450))},!0),arrowCal(placement,align)}}}}}])}();
//# sourceMappingURL=tink-popover-angular.min.map